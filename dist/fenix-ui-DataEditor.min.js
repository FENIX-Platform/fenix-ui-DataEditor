define(["jquery","loglevel","bootstrap","eonasdan-bootstrap-datetimepicker","moment","amplify-pubsub"],function(t,e,o,a,r,s){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){var i,o;i=[n(2),n(3),n(51),n(4),n(50),n(52)],o=function(t,e,n,i,o,a){function r(n,i,o){V=i,k=new e(i),k.render(t(n),V,o)}function s(t,e,n){k.setColumns(t,e,n)}function l(){return k.getColumns()}function d(){return k.getCodelists()}function c(){return k.getData()}function u(){return k.getDataWithoutValidation()}function h(t,e){k.setData(t,e)}function p(t){k.appendData(t)}function f(){k.removeAllData()}function v(){return k.getColumnsWithDistincts()}function g(t,e,n){return k.csvLoaded(t,e,n)}function y(t){k.setStatus(t)}function m(){return k.getStatus()}function b(t){return"undefined"==typeof t?k.isEditable():void k.isEditable(t)}function C(){k&&k.destroy()}function w(){return k.hasChanged()}function D(t,e){return new n(t,e)}function E(){return i}function _(){return new a}function x(){return new o}function M(t,e,n){return k.on(t,e,n)}var k,V={};return{init:r,setColumns:s,getColumns:l,getCodelists:d,getData:c,getDataWithoutValidation:u,setData:h,appendData:p,removeAllData:f,getColumnsWithDistincts:v,isEditable:b,destroy:C,hasChanged:w,CSV_To_Dataset:D,Validator_CSV:E,Columns_Match:_,Data_Validator:x,on:M,csvLoaded:g,setStatus:y,getStatus:m}}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(e,n){e.exports=t},function(t,e,n){var i,o;i=[n(2),n(7),n(8),n(11),n(49),n(50),n(51),n(4),n(52),n(8),n(54),n(48)],o=function(t,e,i,o,a,r,s,l,d,c,u,h){var p={lang:"EN"},f={dataEditorValueChanged:"valueChanged.DataEditor.fenix",dataEditorRowAdded:"rowAdded.DataEditor.fenix",dataEditorRowDeleted:"rowDeleted.DataEditor.fenix"},v={dataUploadColsMatch:"#DataUploadColsMatch",dataEditorContainer:"#divDataEditor",dataUploadContainer:"#DataUploadContainer",divCsvMatcher:"#divCsvMatcher",btnCsvMatcherOk:"#btnCsvMatcherOk",btnCsvMatcherCancel:"#btnCsvMatcherCancel",btnDataMergeKeepNew:"#btnDataMergeKeepNew",btnDataMergeKeepOld:"#btnDataMergeKeepOld",btnDataMergeCancel:"#btnDataMergeCancel"},g={DataMatchColumn:"#DataMatchColumn",btnCsvMatcherOk:"#btnCsvMatcherOk",btnCsvMatcherCancel:"#btnCsvMatcherCancel",DataDuplicateFound:"#DataDuplicateFound",btnDataMergeKeepNew:"#btnDataMergeKeepNew",btnDataMergeKeepOld:"#btnDataMergeKeepOld",btnDataMergeCancel:"#btnDataMergeCancel"},y=function(n){e.info("DataEdit",n),this.config={},t.extend(!0,this.config,p,n),this.$container,this.dataEditor,this.$dataEditor,this.valResView,this.$valResView,this.cols,this.codelists,this.channels={},this.editEnabled=!0,this.changed=!1,this.lang=this.config.lang.toLowerCase()};y.prototype.render=function(r,s,l){t.extend(!0,this.config,s),n(55),e.info("Render - creation",this.config),this.$container=r,this.$container.html(u({btnClear:i[this.lang].btnClear,btnAdd:i[this.lang].btnAdd})),this.$dataEditor=this.$container.find("#divDataEditor"),this.dataEditor=new o(this.config),this.dataEditor.render(this.$container.find("#divDataEdit"),this.config),this.$valResView=this.$container.find("#divValRes"),this.valResView=new a(this.config.lang),this.valResView.render(this.$valResView),this.columnsMatch=new d(this.config),this.status="loading",this.doML();var p=this,g=this;h.subscribe(f.dataEditorValueChanged,this,this.updateValidationOnChange),h.subscribe(f.dataEditorRowAdded,this,this.updateValidationOnChange),h.subscribe(f.dataEditorRowDeleted,this,this.updateValidationOnChange),this.$dataEditor.find("#btnAddRow").on("click",function(t){p.dataEditor.newRow()}),this.$dataEditor.find("#DataDeleteAll").on("click",function(){var t=confirm(c[p.config.lang.toLowerCase()].confirmDelete);t&&p.dataEditor.removeAllData()}),t("#btnDataMergeKeepNew").on("click",function(){g._CSVLoadedMergeData("keepNew")}),t("#btnDataMergeKeepOld").on("click",function(){g._CSVLoadedMergeData("keepOld")}),t("#btnDataMergeCancel").on("click",function(){g.tmpCsvData=null,g.tmpCsvCols=null,g._switchPanelVisibility(t(v.dataEditorContainer))}),l&&l()},y.prototype._trigger=function(t){if(!this.channels[t])return!1;for(var e=Array.prototype.slice.call(arguments,1),n=0,i=this.channels[t].length;n<i;n++){var o=this.channels[t][n];o.callback.apply(o.context,e)}return this},y.prototype.on=function(t,e,n){var i=n||this;return this.channels[t]||(this.channels[t]=[]),this.channels[t].push({context:i,callback:e}),this},y.prototype.updateValidation=function(t){this.changed=!0;var e=new r,n=e.validate(this.cols,this.codelists,t);this.updateValRes(n),this.dataEditor.showValidationResults(n)},y.prototype.updateValidationOnChange=function(t){this.updateValidation(t)},y.prototype.updateValRes=function(t){t?0==t.length?this.$valResView.hide():(this.$valResView.show(),this.valResView.setValidationResults(t)):this.$valResView.hide()},y.prototype.setStatus=function(t){e.warn("StatusSet",t),this.status=t,this._updateStatus()},y.prototype.getStatus=function(){return this.status},y.prototype._updateStatus=function(){t.each(this.$container.find("[data-status]"),function(e,n){t(n).hide()}),this.$container.find("[data-status="+this.status+"]").show()},y.prototype.getValidationResults=function(){var t=new r;return t.validate(this.cols,this.codelists,this.dataEditor.getData())},y.prototype.setColumns=function(t,e,n){if(this.cols=t,this.codelists=e,!this.cols||0==this.cols.length)throw this._trigger("error:showerrormsg",i[this.lang].columnError),new Error(i[this.lang].columnError);this.uiEnabled(!1),this.checkCodeColumnsAndCodelists(this.cols,this.codelists),this.dataEditor.setColumns(this.cols,this.codelists,n),this.uiEnabled(!0)},y.prototype.getColumns=function(){return this.cols},y.prototype.getCodelists=function(){return this.codelists},y.prototype.uiEnabled=function(t){t?(this.$dataEditor.find("#btnAddRow").removeAttr("disabled"),this.$dataEditor.removeAttr("disabled")):(this.$dataEditor.find("#btnAddRow").attr("disabled","disabled"),this.$dataEditor.attr("disabled","disabled"))},y.prototype.checkCodeColumnsAndCodelists=function(t,n){e.info("cLists",n);var o=this;if(t)for(var a=0;a<t.length;a++)if("code"==t[a].dataType){if(!n){var r=i[o.lang].missingCodelist;throw o._trigger("error:showerrormsg",r+t[a].id),new Error(r+t[a].id)}var s=t[a].domain.codes[0].idCodeList;if(t[a].domain.codes[0].version&&(s=s+"|"+t[a].domain.codes[0].version),!(s in n)){var l=i[o.lang].missingCodelistSpecificStart,d=i[o.lang].missingCodelistSpecificEnd;throw o._trigger("error:showerrormsg",l+s+d+t[a].id),new Error(l+s+d+t[a].id)}}},y.prototype.getData=function(){var t=this.dataEditor.getData();this.updateValidation(t);var e=this.getValidationResults();return(null==e||0==e.length)&&t},y.prototype.getDataWithoutValidation=function(){return this.dataEditor.getData()},y.prototype.setData=function(t,e){this.cols&&this.dataEditor.setData(t,e),this.updateValidation(t),this.changed=!1},y.prototype.removeAllData=function(){this.dataEditor.removeAllData()},y.prototype.hasChanged=function(){return this.changed},y.prototype.getColumnsWithDistincts=function(){for(var t=this.dataEditor.getData(),e=0;e<this.cols.length;e++){var n=this.cols[e];switch(n.dataType){case"code":case"customCode":var i=m(t,e);if(i){n.values={codes:[]},n.values.codes[0]={idCodeList:n.domain.codes[0].idCodeList},n.domain.codes[0].version&&(n.values.codes[0].version=n.domain.codes[0].version),n.values.codes[0].codes=[];for(var o=0;o<i.length;o++)n.values.codes[0].codes.push({code:i[o]})}else n.values=null;break;case"date":case"month":case"year":var i=m(t,e);i?n.values={timeList:i}:n.values=null}}return this.cols};var m=function(e,n){var i=[];if(!e)return null;for(var o=0;o<e.length;o++)t.inArray(e[o][n],i)==-1&&i.push(e[o][n]);return i};return y.prototype.isEditable=function(t){return"undefined"==typeof t?this.editEnabled:(t?this.$dataEditor.find("#btnAddRow").show():this.$dataEditor.find("#btnAddRow").hide(),this.editEnabled=t,this.dataEditor.isEditable(t),void 0)},y.prototype.destroy=function(){h.unsubscribe(f.dataEditorValueChanged,this.updateValidation),h.unsubscribe(f.dataEditorRowAdded,this.updateValidation),h.unsubscribe(f.dataEditorRowDeleted,this.updateValidation),this.$dataEditor.find("#btnAddRow").off("click"),this.dataEditor.destroy()},y.prototype.doML=function(){e.info(this.$dataEditor),this.$container.find("#btnAddRow").html(i[this.lang].add),this.$container.find(g.DataMatchColumn).html(i[this.lang].DataMatchColumn),this.$container.find(g.btnCsvMatcherOk).html(i[this.lang].ok),this.$container.find(g.btnCsvMatcherCancel).html(i[this.lang].cancel),this.$container.find(g.DataDuplicateFound).html(i[this.lang].DataDuplicateFound),this.$container.find(g.btnDataMergeKeepNew).html(i[this.lang].btnDataMergeKeepNew),this.$container.find(g.btnDataMergeKeepOld).html(i[this.lang].btnDataMergeKeepOld),this.$container.find(g.btnDataMergeCancel).html(i[this.lang].cancel)},y.prototype._switchPanelVisibility=function(e){t(v.dataUploadColsMatch).hide(),t(v.dataEditorContainer).hide(),t(v.dataUploadContainer).hide(),e.show()},y.prototype._CSVLoadedMergeData=function(n){var o=new r,a=this.getDataWithoutValidation(),s=l,d=s.validateCodes(this.getColumns(),this.getCodelists(),this.tmpCsvCols,this.tmpCsvData),c=s.validate(this.getColumns(),this.getCodelists(),this.tmpCsvCols,this.tmpCsvData);if(c&&c.length>0){for(var u=0;u<c.length;u++)e.info("valRes: "+[c[u].type]+" - codelist: "+c[u].codelistId+" - codes: "+c[u].codes.join(",")),this.updateValRes(c);this._trigger("error:showerrormsg",i[this.lang][c[0].type]),e.info(i[this.lang][c[0].type]),this._trigger("data:restoreupload")}if(d&&d.length>0){for(var u=0;u<d.length;u++)e.info("valRes: "+[d[u].type]+" - codelist: "+d[u].codelistId+" - codes: "+d[u].codes.join(",")),this.updateValRes(d);this._trigger("error:showerrormsg",i[this.lang][d[0].type]),e.info(i[this.lang][d[0].type]),this._trigger("data:restoreupload")}var h=o.checkWrongDataTypes(this.getColumns(),this.codelists,this.tmpCsvData);if(h&&h.length>0){for(u=0;u<h.length;u++)e.info("wrongDatatypes: "+[h[u].error]+" - Row: "+h[u].dataIndex),this.updateValRes(h);return this._trigger("error:showerrormsg",i[this.lang][h[0].error]),e.info(i[this.lang][h[0].error]),this._switchPanelVisibility(t(v.dataEditorContainer)),this._trigger("data:restoreupload"),this.tmpCsvCols=null,void(this.tmpCsvf=null)}o.dataMerge(this.getColumns(),a,this.tmpCsvData,n),this.setData(a),this._switchPanelVisibility(t(v.dataEditorContainer)),this._trigger("data:loaded"),this.tmpCsvCols=null,this.tmpCsvData=null},y.prototype._CSVLoadedCheckDuplicates=function(){var e=this.getDataWithoutValidation(),n=new r,i=n.dataAppendCheck(this.getColumns(),e,this.tmpCsvData);this.setStatus("loaded"),i&&i.length>0?this._switchPanelVisibility(t(v.dataUploadContainer)):this._CSVLoadedMergeData("keepNew")},y.prototype.csvLoaded=function(n,o,a){e.info("csvLoaded",n);var d=this,c=new s(o,a);c.convert(n),this.tmpCsvCols=c.getColumns(),this.tmpCsvData=c.getData();var u=l;this.$csvMatcherOkButton=t("#btnCsvMatcherOk"),this.$csvMatcherCancelButton=t("#btnCsvMatcherCancel"),this.$csvMatcherOkButton.off(),this.$csvMatcherCancelButton.off(),this.columnsMatch.render(t("div#divCsvMatcher")),this.$csvMatcherOkButton.on("click",function(){d.tmpCsvCols=d.columnsMatch.getCsvCols(),d.tmpCsvData=d.columnsMatch.getCsvData(),d.setStatus("loading"),d._CSVLoadedCheckDuplicates()}),this.$csvMatcherCancelButton.on("click",function(){t("div#btnCsvMatcherCancel").off("click"),t("div#btnCsvMatcherOk").off("click"),d.$valResView.hide(),d.tmpCsvData=null,d.tmpCsvCols=null,d._switchPanelVisibility(t(v.dataEditorContainer)),d._trigger("data:restoreupload")});var h=u.validate(this.getColumns(),this.getCodelists(),this.tmpCsvCols,this.tmpCsvData);if(h&&h.length>0){for(var p=0;p<h.length;p++)e.info(h[p].type),this.updateValRes(h);return this._trigger("error:showerrormsg",i[this.lang][h[0].type]),e.info(i[this.lang][h[0].type]),void this._trigger("data:restoreupload")}e.info(this),this._switchPanelVisibility(t(v.dataUploadColsMatch)),this.columnsMatch.setData(this.cols,this.tmpCsvCols,this.tmpCsvData);var f=new r,g=f.checkWrongDataTypes(this.getColumns(),this.codelists,this.tmpCsvData);if(g&&g.length>0){for(p=0;p<g.length;p++){var y=g[p].colId[this.lang.toLowerCase()]||g[p].colId[Object.keys(g[p].colId)[0]];e.info("wrongDatatypes>"+[g[p].error]+" - Row: "+g[p].dataIndex,g[p].cListUID,y)}return this.tmpCsvData.length==g.length&&this._trigger("error:showerrormsg",i[this.lang].CodeListError),e.info(i[this.lang][g[0].error]),void this._trigger("error:showerrormsg",i[this.lang][g[0].error])}},y}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e,n){var o,a;o=[n(2),n(5),n(6)],a=function(t,e,n){function o(){}function a(e,n,i){var o=!0;return t.each(i,function(i,a){if(a.length>0&&"string"==typeof a){if(e.length>i)switch(e[i].dataType){case"code":t.each(n,function(e,n){t.each(n.data,function(t,e){a==e.code&&(o=!1)})})}}else o=!1}),o}function r(t){return"code"==t||("number"==t||"pecentage"==t)}function s(t,e){var i=new n,o=i.findCodeInCodelist(e,t);return null!=o}return o.prototype.validate=function(n,i,o,s){var l=[];if(!a(n,i,o))return l.push({type:e.MISSING_DSD_HEADER}),l;if(!n)return l.push({type:e.DSD_COLUMNS_NULL}),l;if(!o)return l.push({type:e.CSV_COLUMNS_NULL}),l;if(n.length>o.length)return l.push({type:e.WRONG_COLUMN_COUNT}),l;var d=[],c=function(e,n){var i="";return t.each(n,function(t,n){n.key===!0&&(i+="-"+String(e[t]))}),i},u=function(t){for(var e=t.slice().sort(),n=[],i=0;i<t.length-1;i++)e[i+1]==e[i]&&n.push(e[i]);return n},h=function(t,e){for(var n=[],i=-1;(i=t.indexOf(e,i+1))!=-1;)n.push(i+1);return n};t.each(s,function(t,e){d.push(c(e,n))});var p=u(d);p=p.filter(function(t,e){return p.indexOf(t)==e}),t.each(p,function(t,n){l.push({error:e.CSV_DUPLICATE,dataIndex:h(d,n)})});for(var f=0,v=0;v<n.length;v++)if(r(n[v].dataType))for(f=0;f<s.length;f++)""==s[f][v]&&(s[f][v]=null);return l},o.prototype.validateCodes=function(t,n,o,a){var r=[];if(null==a||0==a.length)return r;if(null==o||0==o.length)return r;for(i=0;i<t.length;i++)if("code"==t[i].dataType){var s=t[i].domain.codes[0].idCodeList;t[i].domain.codes[0].version&&(s+="|"+t[i].domain.codes[0].version);var l=this.checkCodes(t[i],n[s],a,i);l.length>0&&r.push({type:e.UNKNOWN_CODES,columnId:o[i],codes:l,codelistId:s})}return r},o.prototype.checkCodes=function(e,n,i,o){for(var a=[],r=0;r<i.length;r++)if(i[r][o]){var l=s(n,i[r][o]);if(!l){var d=i[r][o];t.inArray(d,a)==-1&&a.push(d)}}return a},new o}.apply(e,o),!(void 0!==a&&(t.exports=a))},function(t,e,n){var i,o;i=[],o=function(){"use strict";var t={DSD_COLUMNS_NULL:"nullDSDCols",CSV_COLUMNS_NULL:"nullCsvCols",WRONG_COLUMN_COUNT:"wrongColumnCount",MISSING_DSD_HEADER:"missingDSDHeader",WRONG_COLUMN_ID:"wrongColumnId",UNKNOWN_CODES:"unknownCodes",CSV_DUPLICATE:"csvDuplicate"};return t}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e,n){var i,o;i=[n(2),n(7)],o=function(t,e){function n(){}function i(t,e){for(var n=0;n<t.length;n++)if(t[n].code==e)return t[n];var o=null;for(n=0;n<t.length&&null==o;n++)t[n].children&&(o=i(t[n].children,e));return o}return n.prototype.findCodeInCodelist=function(t,e){var n=i(e.data,t);return n},n}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,n){t.exports=e},function(t,e,n){var i,o;i=[n(9),n(10)],o=function(t,e){"use strict";return{en:t,fr:e}}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e,n){var i;i=function(){"use strict";return{ok:"Ok",cancel:"Cancel",edit:"Edit the row",delete:"Delete the row",confirmDelete:"Delete the row?",unsavedData:"Some changes were not saved, cancel anyway?",btnClear:"Clear all data",btnAdd:"Add a row",nullDSDCols:"DSD columns are not setted.",nullCsvCols:"CSV columns are not setted.",wrongColumnCount:"Wrong Column Count",missingDSDHeader:"DSD Header is missing",unknownCodes:"Unknow codes",csvDuplicate:"Some CSV rows are duplicated",columnError:"At least one column must be defined",missingCodelist:"Missing codelist for the column ",missingCodelistSpecificStart:"Missing codelist ",missingCodelistSpecificEnd:" for the column ",nullKey:"Key fields cannot be empty",sameKeyVals:"Key fields cannot be duplicated",unknownCode:"Unknown code",invalidYear:"Year is not valid",invalidMonth:"Month is not valid",invalidDate:"Date is not valid",invalidNumber:"Number is not valid",invalidBool:"Boolean is not valid",NAN:"Value is not a number",OutOfRange:"Value is out of the allowed range",Null:"Value cannot be blank",line:"line",codelist:"codelist",column:"column",CodeListError:"All lines contain a wrong code. Please check the DSD for the right kind of codelist",DataMatchColumn:"Match the DSD columns with the CSV ones",DataDuplicateFound:"Some duplicated values found, keep old data or replace with the new values just uploaded?",btnDataMergeKeepNew:"Replace with new value",btnDataMergeKeepOld:"Keep old values"}}.call(e,n,e,t),!(void 0!==i&&(t.exports=i))},function(t,e,n){var i;i=function(){"use strict";return{ok:"Ok",cancel:"Annuler",edit:"Modifier la ligne",delete:"Supprimer la ligne",confirmDelete:"Voulez-vous supprimer la ligne?",unsavedData:"Certains changements n'ont pas été enregistrés, voulez-vous annuler quand même?",btnClear:"Effacer toutes les données",btnAdd:"Ajouter une ligne",nullDSDCols:"Les colonnes dans le DSD ne sont pas définies.",nullCsvCols:"Les colonnes dans le CSV ne sont pas définies.",wrongColumnCount:"Décompte de colonne incorrect",missingDSDHeader:"L'en-tête du DSD est manquant",unknownCodes:"Codes inconnus",csvDuplicate:"Certaines lignes du CSV sont dupliquées",columnError:"Au moins une colonne doit être définie",missingCodelist:"Liste des codes manquants pour la colonne ",missingCodelistSpecificStart:"Liste des codes manquants ",missingCodelistSpecificEnd:" pour la colonne ",nullKey:"Les champs clés ne peuvent pas être vides",sameKeyVals:"Les champs clés ne peuvent pas être dupliqués",unknownCode:"Code inconnu",invalidYear:"L'année n'est pas valable",invalidMonth:"Le mois n'est pas valable",invalidDate:"La date n'est pas valable",invalidNumber:"Le nombre n'est pas valable",invalidBool:"Le booléen n'est pas valable",NAN:"La valeur n'est pas numérique",OutOfRange:"La valeur est hors de l'intervalle autorisé",Null:"La valeur ne peut pas être vide",line:"ligne",codelist:"codeliste",column:"colonne",CodeListError:"Toutes les lignes contiennent un code erroné. Veuillez vérifier que les codelistes dans le DSD soient correctes",DataMatchColumn:"Veuillez faire correspondre les colonnes du DSD avec celles du CSV",DataDuplicateFound:"Des valeurs dupliquées ont été trouvées, voulez-vous conserver les données anciennes ou les remplacer par les nouvelles valeurs que vous venez de télécharger?",btnDataMergeKeepNew:"Remplacer par les valeurs nouvelles",btnDataMergeKeepOld:"Conserver les valeurs anciennes"}}.call(e,n,e,t),!(void 0!==i&&(t.exports=i))},function(t,e,n){var i,o;i=[n(2),n(7),n(12),n(45),n(46),n(8),n(47),n(48),n(16)],o=function(t,e,n,i,o,a,r,s){function l(t,e,n,i,o,r){var s="<tr>";s+="<td>"+(t+1)+"</td>";for(var l=0;l<e.length;l++)s+="<td>",s+=null===i[l]?"":"code"==e[l].dataType?d(e[l],n,i[l],r):i[l],s+="</td>";if(o){var c=a[r].edit,u=a[r].delete;s+='<td align="center">'+m.btnEdit.replace("%idx%",t).replace("%tit%",c)+"</td>",s+='<td align="center">'+m.btnDel.replace("%idx%",t).replace("%tit%",u)+"</td>"}return s+="</tr>"}function d(t,e,n){var i=w(t.domain),o=D(e[i].data,n);return null===o?"":o}function c(t,e){var n={};for(var i in t)n[i]={metadata:{}},n[i].data=u(t[i].data,e);return n}function u(t,e){if(!t)return null;var n=[];return h(t,n,e),n}function h(t,e,n){if(t)for(var i=0;i<t.length;i++)e.push(p(t[i],n)),t[i].children&&h(t[i].children,e)}function p(t,e){var n=function(t,e){if(!t)return"";if(e||(e="EN"),e=e.toUpperCase(),e in t)return e;if("EN"in t)return"EN";for(var n in t)return n};return{level:t.level,title:t.title[n(t.title,e)]+" ["+t.code+"]",code:t.code}}var f="DataEditor",v={thButtons:"<th>E</th><th>D</th>"},g={EVT_VALUE_CHANGED:"valueChanged."+f+".fenix",EVT_ROW_ADDED:"rowAdded."+f+".fenix",EVT_ROW_DELETED:"rowDeleted."+f+".fenix"},y={divDataGrid:"#divDataGrid",divRowEditorPopup:"#divRowEditorPopup",btnEditRowCanc:"#btnEditRowCanc",btnEditRowOk:"#btnEditRowOk",tblDataBody:"#tblDataBody",tblDataHead:"#tblDataHead",editButtonsClass:"bE",delButtonsClass:"bD"},m={btnEdit:'<button title="%tit%" type="button" class="btn btn-default bE" data-rid=%idx%><span class="glyphicon glyphicon-pencil"></span></button>',btnDel:'<button title="%tit%" type="button" class="btn btn-default bD"data-rid=%idx%><span class="glyphicon glyphicon-trash"></span></button>'},b=function(e){this.config={},t.extend(!0,this.config,e,v),this.rowEditor=new n,this.$cnt,this.$editWindow,this.$dataGrid,this.$dataModal,this.cols,this.codelists,this.data=[],this.$tBody,this.editEnabled=!0,this.rowsLimit,this.lang="en"};b.prototype.render=function(n,r,s){t.extend(!0,this.config,r),this.$cnt=n,this.$cnt.html(o),this.lang=this.config.lang.toLowerCase(),this.$dataGrid=this.$cnt.find(y.divDataGrid),t("body").find(y.divRowEditorPopup).length||t("body").append(i({btnDelete:a[this.lang].cancel,btnOk:a[this.lang].ok})),this.$editWindow=t("body").find(y.divRowEditorPopup),this.rowEditor.render(this.$editWindow),this._bindEvents(),this.$tBody=this.$cnt.find(y.tblDataBody),this._doML(),s&&s(),e.info("DataEditor rendered",this.config)},b.prototype.setColumns=function(t,e,n){this.cols=t,this.codelists=c(e,this.lang),t&&(this.updateTableHeader(),this.rowEditor.setColumns(this.cols,this.codelists),n&&n())};var C=function(t){return"<th>"+t+"</th>"};b.prototype._showEditWindow=function(t){e.info("_showEditWindow",t),this.$editWindow.modal("show"),this.rowEditor.reset(),t&&this.rowEditor.setRow(t);var n=this;this.$editWindow.on("keyup",function(t){13==t.keyCode&&n.rowEditOk()})},b.prototype._bindEvents=function(){e.info("Data Editor - _bindEvents");var t=this;this.$editWindow.find(y.btnEditRowCanc).on("click",function(){t.rowEditor.changed()&&!confirm(a[t.lang].unsavedData)||t.$editWindow.modal("hide")}),this.$editWindow.find(y.btnEditRowOk).on("click",function(){t.rowEditOk()}),this.$editWindow.on("hidden.bs.modal",function(e){t.rowEditor.reset(),t.$editWindow.off("keyup")})},b.prototype._unbindEvents=function(){this.$editWindow.find(y.btnEditRowCanc).off("click"),this.$editWindow.find(y.btnEditRowOk).off("click"),this.$editWindow.off("hidden.bs.modal"),this.$tBody.find("."+y.editButtonsClass).off("click"),this.$tBody.find("."+y.delButtonsClass).off("click")},b.prototype.destroy=function(){this._unbindEvents(),this.rowEditor.destroy(),this.$tBody.html(""),this.$editWindow.remove()},b.prototype.rowEditOk=function(){if(!this.rowEditor.isValid())return void this.rowEditor.updateValidationHelp();var t=this.rowEditor.getRow();if(t.uid!=-1){this.data[t.uid]=t.data;var e={};e.newData=t.data,e.allData=this.data,s.publish(g.EVT_VALUE_CHANGED,e)}else{this.data.push(t.data);var e={};e.allData=this.data,s.publish(g.EVT_ROW_ADDED,e)}this.updateTable(),this.$editWindow.modal("hide")},b.prototype.newRow=function(){this._showEditWindow(null)},b.prototype.isEditable=function(t){if(this.editEnabled=t,this.cols){if("undefined"==typeof t)return this.editEnabled;this.updateTableHeader(),this.updateTable(this.rowsLimit)}},b.prototype.setData=function(t,e){if(!this.cols)throw new Error("Cannot set data without table structure, use setColumns before setData");t&&(this.data=t,this.rowsLimit=e,this.updateTable(this.rowsLimit))},b.prototype.removeAllData=function(){this.data=[],this.updateTable(),s.publish(g.EVT_ROW_DELETED,this.data)},b.prototype.updateTableHeader=function(){var t=this.$cnt.find(y.tblDataHead);t.html(""),t.append("<th>#</th>");for(var e=0;e<this.cols.length;e++)t.append(C(this.cols[e].title[this.lang.toUpperCase()]));this.editEnabled&&t.append(this.config.thButtons)},b.prototype.updateTable=function(e){var n=e||this.data.length;if(n>this.data.length&&(n=this.data.length),this.$tBody.html(""),this.data){for(var i=0;i<n;i++)this.$tBody.append(l(i,this.cols,this.codelists,this.data[i],this.editEnabled,this.lang));if(e<this.data.length&&this.$tBody.append('<tr><td colspan="'+(this.cols.length+3)+'">...</td></tr>'),this.editEnabled){var o=this;this.$tBody.find("."+y.editButtonsClass).on("click",function(){var e=t(this).data("rid");o._showEditWindow({uid:e,data:o.data[e]})}),this.$tBody.find("."+y.delButtonsClass).on("click",function(){var e=confirm(a[o.lang].confirmDelete);e&&o.deleteRow(t(this).data("rid"))})}}},b.prototype.deleteRow=function(t){this.data.splice(t,1),this.updateTable(),s.publish(g.EVT_ROW_DELETED,this.data)},b.prototype.getRowByRowId=function(e){for(var n=this.$tBody.find("tr"),i=0;i<n.length;i++)if(e==t(n[i]).find("td:first").html())return t(n[i]);return null};var w=function(t){var e=t.codes[0].idCodeList;return t.codes[0].version&&(e+="|"+t.codes[0].version),e},D=function(t,e){if(!t)return null;for(var n=0;n<t.length;n++)if(t[n].code==e)return t[n].title;return null};return b.prototype.getData=function(){return e.info("getData ",this.data),this.data},b.prototype.showValidationResults=function(t){},b.prototype.resetValidationResults=function(){},b.prototype.setRowColor=function(t,e){},b.prototype.setCellColor=function(t,e,n){},b.prototype.setCellError=function(t,e){},b.prototype.changeCellBackgroundColor=function(t,e){},b.prototype._doML=function(){},b}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e,n){var i,o;i=[n(2),n(7),n(8),n(13)],o=function(t,e,n,i){function o(t){return"trRowEdit_"+t}var a={YMin:0,YMax:3e3,decimalDigits:5},i=new i,r=function(e){this.config={},t.extend(!0,this.config,a,e),this.$window,this.cols,this.codelists,this.lang="EN",localStorage.getItem("locale")&&(this.lang=localStorage.getItem("locale")),this.lang=this.lang.toLowerCase(),this.editors=[],this.uidInEdit=-1,this.oldVal=null};return r.prototype.render=function(e,n){t.extend(!0,this.config,n),this.$window=e},r.prototype.setColumns=function(t,e){this.cols=t,this.codelists=e,t&&this.createStrucure()},r.prototype.createStrucure=function(){this.editors=[];for(var t,e=this.$window.find("#tblRowEditor"),n=e.find("tbody"),a=0;a<this.cols.length;a++)t="<tr>",t+="<td>"+this.cols[a].title[this.lang.toUpperCase()]+"</td>",t+='<td><div id="'+o(this.cols[a].id)+'"></div></td>',t+="</tr>",n.append(t);for(var a=0;a<this.cols.length;a++){var r=this.cols[a],s=n.find("#"+o(r.id)),l=null;switch(this.editors[a]=i.create(r.dataType,l),r.dataType){case"code":var d=r.domain.codes[0].idCodeList;r.domain.codes[0].version&&(d+="|"+r.domain.codes[0].version),this.editors[a].render(s,null,[this.codelists[d]]);break;case"customCode":break;case"year":var c=this.config.YMin,u=this.config.YMax;r.domain&&r.domain.period&&(c=r.domain.period.from,u=r.domain.period.to),this.editors[a].render(s,{yMin:c,yMax:u});break;case"number":case"percentage":this.editors[a].render(s,{decimalDigits:this.config.decimalDigits});break;case"month":case"date":case"text":case"bool":this.editors[a].render(s,null)}r.key&&this.editors[a].isMandatory(!0)}},r.prototype.reset=function(t){if(e.info("RowEditorPopup - reset",this.editors,this.cols.length,t),this.uidInEdit=-1,this.cols){for(var n=0;n<this.cols.length;n++)this.editors[n].reset();this.oldVal=null}},r.prototype.updateValidationHelp=function(){if(this.cols)for(var t=0;t<this.cols.length;t++)this.editors[t].updateValidationHelp&&this.editors[t].updateValidationHelp()},r.prototype.isValid=function(){for(var t=0;t<this.cols.length;t++)if(!this.editors[t].isValid())return!1;return!0},r.prototype.setRow=function(t){if(e.info("setRow",t),this.reset(),!this.cols)throw new Error("cannot set row when columns are null");this.oldVal=t,"undefined"!=t.uid?this.uidInEdit=t.uid:this.uidInEdit=-1;for(var n=0;n<this.cols.length;n++){if(!this.editors[n])throw new Error("Editor cannot be null for dataType "+this.cols[n].dataType);this.editors[n].setValue(t.data[n])}},r.prototype.getRow=function(t){if(!this.cols)throw new Error("cannot get row when columns are null");for(var e={uid:this.uidInEdit,data:[]},n=0;n<this.cols.length;n++){var i=this.editors[n].getValue();i?"number"==this.cols[n].dataType||"percentage"==this.cols[n].dataType?e.data[n]=parseFloat(i):e.data[n]=i:e.data[n]=null}return e},r.prototype.changed=function(){var t=this.getRow();if(null==this.oldVal){for(var e=0;e<this.cols.length;e++)if(""!=t.data[e])return!0}else for(var e=0;e<this.cols.length;e++)if(t.data[e]!=this.oldVal.data[e])return!0;return!1},r.prototype.destroy=function(){if(this.cols)for(var t=0;t<this.cols.length;t++)this.editors[t].destroy()},r}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e,n){var i,o;i=[n(2),n(14),n(17),n(18),n(41),n(42),n(43),n(44)],o=function(t,e,n,i,o,a,r,s){var l={},d=function(e){this.config={},t.extend(!0,this.config,l,e)};return d.prototype.create=function(t,l){switch(t){case"code":return new n(l);case"customCode":break;case"year":return new s(l);case"month":return new o(l);case"date":return new i(l);case"number":case"percentage":return new a(l);case"text":return new r(l);case"bool":return new e(l)}},d}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e,n){var i,o;i=[n(2),n(8),n(15),n(16)],o=function(t,e,n){var i=function(t){this.parent.constructor.call(this,t)};return i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.parent=n.prototype,i.prototype.render=function(e,n){t.extend(!0,this.config,n),this.$cnt=e;var i='<input type="checkbox" />';this.$cnt.html(i);var o=this,a=this.$cnt.find("input");a.show(),a.on("click",function(){o.updateValidationHelp()})},i.prototype.destroy=function(){this.$cnt.find("input").off("click")},i.prototype.updateValidationHelp=function(){var t=this.validate();this.parent.updateValidationHelp.call(this,t)},i.prototype.reset=function(){this.$cnt.find("input").prop("checked",!1),this.$cnt.popover("destroy")},i.prototype.setValue=function(t){this.reset(),this.$cnt.find("input").prop("checked",t)},i.prototype.getValue=function(){return this.$cnt.find("input").prop("checked")},i.prototype.isMandatory=function(t){return"undefined"==t?this.mandatory:void(this.mandatory=t)},i.prototype.validate=function(){return null},i.prototype.isValid=function(){return null==this.validate()},i}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e,n){var i,o;i=[n(2),n(8),n(16)],o=function(t,e){var n={},i=function(e){this.config={},t.extend(!0,this.config,n,e),this.$cnt,this.mandatory=!1,this.ERROR_NAN="NAN",this.ERROR_OUT_OF_RANGE="OutOfRange",this.ERROR_NULL="Null"};return i.prototype.updateValidationHelp=function(){var t=this.validate();if(null==t)this.$cnt.popover("destroy");else{var n=e[t];this.$cnt.popover({container:this.$cnt,content:n,html:!0}),this.$cnt.popover("show")}},i.prototype.isMandatory=function(t){return"undefined"==t?this.mandatory:void(this.mandatory=t)},i.prototype.isValid=function(){return null==this.validate()},i}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e){t.exports=o},function(t,e,n){var i,o;i=[n(2),n(8),n(15)],o=function(t,e,n){function i(t,e,n){if(0==t)return title;var i=o.optionCode;i=i.replace("%lev%",e);var a="";switch(e){case 2:a="&nbsp;";break;case 3:a="&nbsp;&nbsp;";break;case 4:a="&nbsp;&nbsp;&nbsp;";break;default:a="&nbsp;&nbsp;&nbsp;&nbsp;"}return i.replace("%label%",a+""+n)}var o={elemCode:'<select class="%class%"></select>',elemClass:"form-control",optionCode:'<span class="cl_lev%lev%">%label%</span>',emptyEntryValue:"-",emptyEntryLabel:"-"},a=function(e){this.parent.constructor.call(this,e),t.extend(!0,this.config,o),this.codelists,this.$ddl};return a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.prototype.parent=n.prototype,a.prototype.render=function(e,n,i){t.extend(!0,this.config,n),this.$cnt=e,this.codelists=i,this.createEditor()},a.prototype.createEditor=function(){var e=o.elemCode.replace("%class%",o.elemClass);if(this.$ddl=t(e),this.codelists&&this.codelists[0]&&this.codelists[0].data){
var n=t("<option></option>");n.val(this.config.emptyEntryValue),n.html(this.config.emptyEntryLabel),this.$ddl.append(n);for(var a=0;a<this.codelists[0].data.length;a++)n=t("<option></option>").val(this.codelists[0].data[a].code),n.html(i(this.codelists[0].metadata.levels,this.codelists[0].data[a].level,this.codelists[0].data[a].title)),this.$ddl.append(n);this.$cnt.append(this.$ddl),this._bindEvents()}},a.prototype._bindEvents=function(){var t=this;this.$cnt.on("select",function(){t.updateValidationHelp()})},a.prototype._unbindEvents=function(){this.$cnt.off("select")},a.prototype.destroy=function(){this._unbindEvents()},a.prototype.updateValidationHelp=function(){var t=this.validate();this.parent.updateValidationHelp.call(this,t)},a.prototype.reset=function(){this.$ddl.val(this.config.emptyEntryValue)},a.prototype.setValue=function(t){this.reset(),this.$ddl.val(t),this.updateValidationHelp()},a.prototype.getValue=function(){var t=this.$ddl.val();return t==this.config.emptyEntryValue?"":t},a.prototype.isMandatory=function(t){return"undefined"==t?this.mandatory:void(this.mandatory=t)},a.prototype.validate=function(){var t=this.getValue();return this.mandatory&&!t?this.ERROR_NULL:null},a.prototype.isValid=function(){return null==this.validate()},a}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e,n){var i,o;i=[n(2),n(19),n(8),n(15),n(20),n(40),n(16)],o=function(t,e,n,i,o){var a={yMin:0,yMax:3e3},r=function(e){this.parent.constructor.call(this,e),t.extend(!0,this.config,a),this.$datePicker};return r.prototype=Object.create(i.prototype),r.prototype.constructor=i,r.prototype.parent=i.prototype,r.prototype.render=function(e,n){t.extend(!0,this.config,n),this.$cnt=e,this.$cnt.html(o),this.$datePicker=this.$cnt.find("#inputTime"),this.$datePicker.datetimepicker({viewMode:"days",locale:"en",format:"DD/MM/YYYY"});var i=this;this.$cnt.on("change",function(){i.updateValidationHelp()})},r.prototype.destroy=function(){this.$datePicker.data("DateTimePicker").destroy(),this.$datePicker.off("change")},r.prototype.reset=function(){this.$datePicker.data("DateTimePicker").clear()},r.prototype.setValue=function(t){if(this.reset(),t){t=""+t;var e=t.substring(6,8),n=t.substring(4,6);n-=1;var i=t.substring(0,4);this.$datePicker.data("DateTimePicker").date(new Date(i,n,e))}},r.prototype.getValue=function(){var t=this.$datePicker.data("DateTimePicker").date();if(!t)return"";var e=""+t.date(),n=""+(t.month()+1),i=""+t.year();for(1==e.length&&(e="0"+e),1==n.length&&(n="0"+n);i.length<4;)i="0"+i;return i+n+e},r.prototype.validate=function(){var t=this.getValue();if(this.mandatory&&!t)return this.ERROR_NULL;var e=t.substring(4,8);return e<this.config.yMin?this.ERROR_OUT_OF_RANGE:e>this.config.yMax?this.ERROR_OUT_OF_RANGE:null},r}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e){t.exports=a},function(t,e,n){var i=n(21);t.exports=(i.default||i).template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,o){return'<div class=\'input-group date\' id=\'inputTime\'>\r\n    <input type="text" class="form-control" />\r\n    <span class="input-group-addon">\r\n        <span class="glyphicon glyphicon-calendar"></span>\r\n    </span>\r\n</div>'},useData:!0})},function(t,e,n){t.exports=n(22).default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function a(){var t=new s.HandlebarsEnvironment;return p.extend(t,s),t.SafeString=d.default,t.Exception=u.default,t.Utils=p,t.escapeExpression=p.escapeExpression,t.VM=v,t.template=function(e){return v.template(e,t)},t}e.__esModule=!0;var r=n(23),s=o(r),l=n(37),d=i(l),c=n(25),u=i(c),h=n(24),p=o(h),f=n(38),v=o(f),g=n(39),y=i(g),m=a();m.create=a,y.default(m),m.default=m,e.default=m,t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n){this.helpers=t||{},this.partials=e||{},this.decorators=n||{},l.registerDefaultHelpers(this),d.registerDefaultDecorators(this)}e.__esModule=!0,e.HandlebarsEnvironment=o;var a=n(24),r=n(25),s=i(r),l=n(26),d=n(34),c=n(36),u=i(c),h="4.0.5";e.VERSION=h;var p=7;e.COMPILER_REVISION=p;var f={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};e.REVISION_CHANGES=f;var v="[object Object]";o.prototype={constructor:o,logger:u.default,log:u.default.log,registerHelper:function(t,e){if(a.toString.call(t)===v){if(e)throw new s.default("Arg not supported with multiple helpers");a.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(a.toString.call(t)===v)a.extend(this.partials,t);else{if("undefined"==typeof e)throw new s.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if(a.toString.call(t)===v){if(e)throw new s.default("Arg not supported with multiple decorators");a.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]}};var g=u.default.log;e.log=g,e.createFrame=a.createFrame,e.logger=u.default},function(t,e){"use strict";function n(t){return c[t]}function i(t){for(var e=1;e<arguments.length;e++)for(var n in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],n)&&(t[n]=arguments[e][n]);return t}function o(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1}function a(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return h.test(t)?t.replace(u,n):t}function r(t){return!t&&0!==t||!(!v(t)||0!==t.length)}function s(t){var e=i({},t);return e._parent=t,e}function l(t,e){return t.path=e,t}function d(t,e){return(t?t+".":"")+e}e.__esModule=!0,e.extend=i,e.indexOf=o,e.escapeExpression=a,e.isEmpty=r,e.createFrame=s,e.blockParams=l,e.appendContextPath=d;var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},u=/[&<>"'`=]/g,h=/[&<>"'`=]/,p=Object.prototype.toString;e.toString=p;var f=function(t){return"function"==typeof t};f(/x/)&&(e.isFunction=f=function(t){return"function"==typeof t&&"[object Function]"===p.call(t)}),e.isFunction=f;var v=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===p.call(t)};e.isArray=v},function(t,e){"use strict";function n(t,e){var o=e&&e.loc,a=void 0,r=void 0;o&&(a=o.start.line,r=o.start.column,t+=" - "+a+":"+r);for(var s=Error.prototype.constructor.call(this,t),l=0;l<i.length;l++)this[i[l]]=s[i[l]];Error.captureStackTrace&&Error.captureStackTrace(this,n);try{o&&(this.lineNumber=a,Object.defineProperty?Object.defineProperty(this,"column",{value:r}):this.column=r)}catch(t){}}e.__esModule=!0;var i=["description","fileName","lineNumber","message","name","number","stack"];n.prototype=new Error,e.default=n,t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){r.default(t),l.default(t),c.default(t),h.default(t),f.default(t),g.default(t),m.default(t)}e.__esModule=!0,e.registerDefaultHelpers=o;var a=n(27),r=i(a),s=n(28),l=i(s),d=n(29),c=i(d),u=n(30),h=i(u),p=n(31),f=i(p),v=n(32),g=i(v),y=n(33),m=i(y)},function(t,e,n){"use strict";e.__esModule=!0;var i=n(24);e.default=function(t){t.registerHelper("blockHelperMissing",function(e,n){var o=n.inverse,a=n.fn;if(e===!0)return a(this);if(e===!1||null==e)return o(this);if(i.isArray(e))return e.length>0?(n.ids&&(n.ids=[n.name]),t.helpers.each(e,n)):o(this);if(n.data&&n.ids){var r=i.createFrame(n.data);r.contextPath=i.appendContextPath(n.data.contextPath,n.name),n={data:r}}return a(e,n)})},t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=n(24),a=n(25),r=i(a);e.default=function(t){t.registerHelper("each",function(t,e){function n(e,n,a){d&&(d.key=e,d.index=n,d.first=0===n,d.last=!!a,c&&(d.contextPath=c+e)),l+=i(t[e],{data:d,blockParams:o.blockParams([t[e],e],[c+e,null])})}if(!e)throw new r.default("Must pass iterator to #each");var i=e.fn,a=e.inverse,s=0,l="",d=void 0,c=void 0;if(e.data&&e.ids&&(c=o.appendContextPath(e.data.contextPath,e.ids[0])+"."),o.isFunction(t)&&(t=t.call(this)),e.data&&(d=o.createFrame(e.data)),t&&"object"==typeof t)if(o.isArray(t))for(var u=t.length;s<u;s++)s in t&&n(s,s,s===t.length-1);else{var h=void 0;for(var p in t)t.hasOwnProperty(p)&&(void 0!==h&&n(h,s-1),h=p,s++);void 0!==h&&n(h,s-1,!0)}return 0===s&&(l=a(this)),l})},t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var o=n(25),a=i(o);e.default=function(t){t.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new a.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0;var i=n(24);e.default=function(t){t.registerHelper("if",function(t,e){return i.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||i.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,n){return t.helpers.if.call(this,e,{fn:n.inverse,inverse:n.fn,hash:n.hash})})},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("log",function(){for(var e=[void 0],n=arguments[arguments.length-1],i=0;i<arguments.length-1;i++)e.push(arguments[i]);var o=1;null!=n.hash.level?o=n.hash.level:n.data&&null!=n.data.level&&(o=n.data.level),e[0]=o,t.log.apply(t,e)})},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",function(t,e){return t&&t[e]})},t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0;var i=n(24);e.default=function(t){t.registerHelper("with",function(t,e){i.isFunction(t)&&(t=t.call(this));var n=e.fn;if(i.isEmpty(t))return e.inverse(this);var o=e.data;return e.data&&e.ids&&(o=i.createFrame(e.data),o.contextPath=i.appendContextPath(e.data.contextPath,e.ids[0])),n(t,{data:o,blockParams:i.blockParams([t],[o&&o.contextPath])})})},t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){r.default(t)}e.__esModule=!0,e.registerDefaultDecorators=o;var a=n(35),r=i(a)},function(t,e,n){"use strict";e.__esModule=!0;var i=n(24);e.default=function(t){t.registerDecorator("inline",function(t,e,n,o){var a=t;return e.partials||(e.partials={},a=function(o,a){var r=n.partials;n.partials=i.extend({},r,e.partials);var s=t(o,a);return n.partials=r,s}),e.partials[o.args[0]]=o.fn,a})},t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0;var i=n(24),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=i.indexOf(o.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=o.lookupLevel(t),"undefined"!=typeof console&&o.lookupLevel(o.level)<=t){var e=o.methodMap[t];console[e]||(e="log");for(var n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];console[e].apply(console,i)}}};e.default=o,t.exports=e.default},function(t,e){"use strict";function n(t){this.string=t}e.__esModule=!0,n.prototype.toString=n.prototype.toHTML=function(){return""+this.string},e.default=n,t.exports=e.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function a(t){var e=t&&t[0]||1,n=y.COMPILER_REVISION;if(e!==n){if(e<n){var i=y.REVISION_CHANGES[n],o=y.REVISION_CHANGES[e];throw new g.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+i+") or downgrade your runtime to an older version ("+o+").")}throw new g.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function r(t,e){function n(n,i,o){o.hash&&(i=f.extend({},i,o.hash),o.ids&&(o.ids[0]=!0)),n=e.VM.resolvePartial.call(this,n,i,o);var a=e.VM.invokePartial.call(this,n,i,o);if(null==a&&e.compile&&(o.partials[o.name]=e.compile(n,t.compilerOptions,e),a=o.partials[o.name](i,o)),null!=a){if(o.indent){for(var r=a.split("\n"),s=0,l=r.length;s<l&&(r[s]||s+1!==l);s++)r[s]=o.indent+r[s];a=r.join("\n")}return a}throw new g.default("The partial "+o.name+" could not be compiled when running in runtime-only mode")}function i(e){function n(e){return""+t.main(o,e,o.helpers,o.partials,r,l,s)}var a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=a.data;i._setup(a),!a.partial&&t.useData&&(r=u(e,r));var s=void 0,l=t.useBlockParams?[]:void 0;return t.useDepths&&(s=a.depths?e!=a.depths[0]?[e].concat(a.depths):a.depths:[e]),(n=h(t.main,n,o,a.depths||[],r,l))(e,a)}if(!e)throw new g.default("No environment passed to template");if(!t||!t.main)throw new g.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var o={strict:function(t,e){if(!(e in t))throw new g.default('"'+e+'" not defined in '+t);return t[e]},lookup:function(t,e){for(var n=t.length,i=0;i<n;i++)if(t[i]&&null!=t[i][e])return t[i][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:f.escapeExpression,invokePartial:n,fn:function(e){var n=t[e];return n.decorator=t[e+"_d"],n},programs:[],program:function(t,e,n,i,o){var a=this.programs[t],r=this.fn(t);return e||o||i||n?a=s(this,t,r,e,n,i,o):a||(a=this.programs[t]=s(this,t,r)),a},data:function(t,e){for(;t&&e--;)t=t._parent;return t},merge:function(t,e){var n=t||e;return t&&e&&t!==e&&(n=f.extend({},e,t)),n},noop:e.VM.noop,compilerInfo:t.compiler};return i.isTop=!0,i._setup=function(n){n.partial?(o.helpers=n.helpers,o.partials=n.partials,o.decorators=n.decorators):(o.helpers=o.merge(n.helpers,e.helpers),t.usePartial&&(o.partials=o.merge(n.partials,e.partials)),(t.usePartial||t.useDecorators)&&(o.decorators=o.merge(n.decorators,e.decorators)))},i._child=function(e,n,i,a){if(t.useBlockParams&&!i)throw new g.default("must pass block params");if(t.useDepths&&!a)throw new g.default("must pass parent depths");return s(o,e,t[e],n,0,i,a)},i}function s(t,e,n,i,o,a,r){function s(e){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=r;return r&&e!=r[0]&&(s=[e].concat(r)),n(t,e,t.helpers,t.partials,o.data||i,a&&[o.blockParams].concat(a),s)}return s=h(n,s,t,r,i,a),s.program=e,s.depth=r?r.length:0,s.blockParams=o||0,s}function l(t,e,n){if(t)t.call||n.name||(n.name=t,t=n.partials[t]);else if("@partial-block"===n.name){for(var i=n.data;i["partial-block"]===c;)i=i._parent;t=i["partial-block"],i["partial-block"]=c}else t=n.partials[n.name];return t}function d(t,e,n){n.partial=!0,n.ids&&(n.data.contextPath=n.ids[0]||n.data.contextPath);var i=void 0;if(n.fn&&n.fn!==c&&(n.data=y.createFrame(n.data),i=n.data["partial-block"]=n.fn,i.partials&&(n.partials=f.extend({},n.partials,i.partials))),void 0===t&&i&&(t=i),void 0===t)throw new g.default("The partial "+n.name+" could not be found");if(t instanceof Function)return t(e,n)}function c(){return""}function u(t,e){return e&&"root"in e||(e=e?y.createFrame(e):{},e.root=t),e}function h(t,e,n,i,o,a){if(t.decorator){var r={};e=t.decorator(e,r,n,i&&i[0],o,a,i),f.extend(e,r)}return e}e.__esModule=!0,e.checkRevision=a,e.template=r,e.wrapProgram=s,e.resolvePartial=l,e.invokePartial=d,e.noop=c;var p=n(24),f=o(p),v=n(25),g=i(v),y=n(23)},function(t,e){(function(n){"use strict";e.__esModule=!0,e.default=function(t){var e="undefined"!=typeof n?n:window,i=e.Handlebars;t.noConflict=function(){return e.Handlebars===t&&(e.Handlebars=i),t}},t.exports=e.default}).call(e,function(){return this}())},function(t,e){t.exports=r},function(t,e,n){var i,o;i=[n(2),n(8),n(18),n(16)],o=function(t,e,n){var i=function(t){this.parent.constructor.call(this,t)};return i.prototype=Object.create(n.prototype),i.prototype.constructor=n,i.prototype.parent=n.prototype,i.prototype.render=function(e,n){t.extend(!0,this.config,n),this.parent.render.call(this,e,n),this.$datePicker.data("DateTimePicker").format("MM/YYYY"),this.$datePicker.data("DateTimePicker").viewMode("months")},i.prototype.setValue=function(t){if(this.reset(),t){var e=t.substring(0,4)+"",n=t.substring(4,6)+"";n-=1,this.$datePicker.data("DateTimePicker").date(new Date(e,n,1))}},i.prototype.getValue=function(){var t=this.$datePicker.data("DateTimePicker").date();if(!t)return"";var e=""+(t.month()+1),n=""+t.year();for(1==e.length&&(e="0"+e);n.length<4;)n="0"+n;return n+e},i.prototype.validate=function(){var t=this.getValue();if(this.mandatory&&!t)return this.ERROR_NULL;if(!t)return null;var e=t.substring(0,4),n=t.substring(4,6);return!this.mandatory||""!=n&&""!=e?e<this.config.yMin||e>this.config.yMax?this.ERROR_OUT_OF_RANGE:""==n&&""==e?null:void 0:this.ERROR_NULL},i}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e,n){var i,o;i=[n(2),n(8),n(15),n(16)],o=function(t,e,n){var i={decimalDigits:5,html:'<input type="input" class="form-control">'},o=function(e){this.parent.constructor.call(this,e),t.extend(!0,this.config,i),this.$cnt,this.$txt};return o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.prototype.parent=n.prototype,o.prototype.render=function(e,n){t.extend(!0,this.config,n),this.$cnt=e,this.$cnt.html(this.config.html),this.$txt=this.$cnt.find("input");var i=this;this.$cnt.on("valueChanged",function(){i.updateValidationHelp()})},o.prototype.destroy=function(){this.$cnt.off("valueChanged")},o.prototype.updateValidationHelp=function(){var t=this.validate();this.parent.updateValidationHelp.call(this,t)},o.prototype.reset=function(){this.$txt.val(""),this.$cnt.popover("destroy")},o.prototype.setValue=function(t){this.reset(),this.$txt.val(t)},o.prototype.getValue=function(){var t=this.$txt.val().trim();return t},o.prototype.isMandatory=function(t){return"undefined"==t?this.mandatory:void(this.mandatory=t)},o.prototype.validate=function(){var t=this.getValue();if(""!=t){if(isNaN(t))return this.ERROR_NAN}else if(this.mandatory)return this.ERROR_NULL;return null},o.prototype.isValid=function(){return null==this.validate()},o}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e,n){var i,o;i=[n(2),n(8),n(15),n(16)],o=function(t,e,n){var i={html:'<input type="text" class="form-control">'},o=function(e){this.parent.constructor.call(this,e,i),t.extend(!0,this.config,i),this.$cnt,this.txt};return o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.prototype.parent=n.prototype,o.prototype.render=function(e,n){t.extend(!0,this.config,n),this.$cnt=e,this.$cnt.html(this.config.html),this.txt=this.$cnt.find("input");var i=this;this.$cnt.on("valueChanged",function(){i.updateValidationHelp()})},o.prototype.destroy=function(){this.$cnt.off("valuechanged")},o.prototype.updateValidationHelp=function(){var t=this.validate();this.parent.updateValidationHelp.call(this,t)},o.prototype.reset=function(){this.txt.val(""),this.$cnt.popover("destroy")},o.prototype.setValue=function(t){this.reset(),this.txt.val(t)},o.prototype.getValue=function(){return this.txt.val().trim()},o.prototype.isMandatory=function(t){return"undefined"==t?this.mandatory:void(this.mandatory=t)},o.prototype.validate=function(){var t=this.getValue();return this.mandatory&&""==t.trim()?this.ERROR_NULL:null},o.prototype.isValid=function(){return null==this.validate()},o}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e,n){var i,o;i=[n(2),n(8),n(18),n(16)],o=function(t,e,n){var i=function(t){this.parent.constructor.call(this,t)};return i.prototype=Object.create(n.prototype),i.prototype.constructor=n,i.prototype.parent=n.prototype,i.prototype.render=function(e,n){t.extend(!0,this.config,n),this.parent.render.call(this,e,n),this.$datePicker.data("DateTimePicker").format("YYYY"),this.$datePicker.data("DateTimePicker").viewMode("years")},i.prototype.setValue=function(t){this.reset(),t&&this.$datePicker.data("DateTimePicker").date(new Date(t,0,1))},i.prototype.getValue=function(){var t=this.$datePicker.data("DateTimePicker").date();return t?""+t.year():""},i.prototype.validate=function(){var t=this.getValue();return this.mandatory&&!t?this.ERROR_NULL:t?t<this.config.yMin?this.ERROR_OUT_OF_RANGE:t>this.config.yMax?this.ERROR_OUT_OF_RANGE:void 0:null},i}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e,n){var i=n(21);t.exports=(i.default||i).template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,o){var a,r=null!=e?e:{},s=n.helperMissing,l="function",d=t.escapeExpression;return'<div id="divRowEditorPopup" class="modal fade">\r\n    <div class="modal-dialog modal-lg">\r\n        <div class="modal-content">\r\n            <div class="modal-body">\r\n                <table id="tblRowEditor">\r\n                    <tbody></tbody>\r\n                </table>\r\n            </div>\r\n            <div class="modal-footer">\r\n                <button title="'+d((a=null!=(a=n.btnDelete||(null!=e?e.btnDelete:e))?a:s,typeof a===l?a.call(r,{name:"btnDelete",hash:{},data:o}):a))+'" id="btnEditRowCanc" type="button" class="btn btn-default"><span class="glyphicon glyphicon-remove"></span></button>\r\n                <button title="'+d((a=null!=(a=n.btnOk||(null!=e?e.btnOk:e))?a:s,typeof a===l?a.call(r,{name:"btnOk",hash:{},data:o}):a))+'" id="btnEditRowOk" type="button" class="btn btn-primary fx-button-primary-color"><span class="glyphicon glyphicon-ok"></span></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'},useData:!0})},function(t,e,n){var i=n(21);t.exports=(i.default||i).template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,o){return'<div id="divDataGrid">\r\n    <table id="tblData" class="table table-bordered table-condensed">\r\n        <thead>\r\n            <tr id="tblDataHead"></tr>\r\n        </thead>\r\n        <tbody id="tblDataBody"></tbody>\r\n    </table>\r\n</div>'},useData:!0})},function(t,e){},function(t,e){t.exports=s},function(t,e,n){var i,o;i=[n(2),n(8)],o=function(t,e){var n=function(t){this.lang=t,this.$valResGrid};return n.prototype.render=function(t){this.$valResGrid=t},n.prototype.setValidationResults=function(n){if(this.$valResGrid.html(),n){var i="";i="<table><tbody>";for(var o=0;o<n.length;o++){if(i+="<tr><td>",n[o].dataIndex){i+=e[this.lang.toLowerCase()][n[o].error];var a="";if(Array.isArray(n[o].dataIndex)?t.each(n[o].dataIndex,function(e,i){"csvDuplicate"!=n[o].error&&t("#tblDataBody tr:nth-child("+(i+1)+")").css("background-color","rgba(255,0,0,0.1)").css("color","red"),a+=i+1+" "}):a=n[o].dataIndex,i+=", "+e[this.lang.toLowerCase()].line+": "+a,n[o].cListUID&&(i+="; "+e[this.lang.toLowerCase()].codelist+": "+n[o].cListUID),n[o].colId){var r=n[o].colId[this.lang.toUpperCase()]||n[o].colId[Object.keys(n[o].colId)[0]];i+="; "+e[this.lang.toLowerCase()].column+": "+r}}i+="</tr></td>"}i+="</table></tbody>",this.$valResGrid.html(i)}},n}.apply(e,i),!(void 0!==o&&(t.exports=o))},function(t,e,i){var o,a;o=[i(2),i(7),i(6)],a=function(t,e,i){function o(){}var a="nullKey",r="sameKeyVals",s="unknownCode",l="invalidYear",d="invalidMonth",c="invalidDate",u="invalidNumber",h="invalidBool";o.prototype.validate=function(t,e,n){var i=[],o=this.checkEmptyKeyVals(t,n),a=this.checkDuplicateKeyVals(t,n),r=this.checkWrongDataTypes(t,e,n),s=this.checkValueFlags();return o&&o.length>0&&_(i,o),a&&a.length>0&&_(i,a),r&&r.length>0&&_(i,r),s&&s.length>0&&_(i,s),i},o.prototype.checkEmptyKeyVals=function(t,e){if(!t||!e)return null;for(var n=[],i=0;i<e.length;i++)for(var o=0;o<t.length;o++)t[o].key&&(e[i][o]||n.push({error:a,colId:t[o].id,dataIndex:i}));return n},o.prototype.checkDuplicateKeyVals=function(n,i){if(!n||!i)return null;var o=[],a=[];e.info("**********************************************************"),e.info(n),e.info(i),t.each(i,function(t,e){a.push(g(e,n))});var s=f(a);return e.info(a),e.info(s),s=s.filter(function(t,e){return s.indexOf(t)==e}),t.each(s,function(t,e){o.push({error:r,dataIndex:p(a,e)})}),o};var p=function(t,e){for(var n=[],i=-1;(i=t.indexOf(e,i+1))!=-1;)n.push(i);return n},f=function(t){for(var e=t.slice().sort(),n=[],i=0;i<t.length-1;i++)e[i+1]==e[i]&&n.push(e[i]);return n},v=function(t,e,n){for(var i=0;i<n.length;i++)if(n[i].key&&t[i]!=e[i])return!1;return!0},g=function(e,n){var i="";return t.each(n,function(t,n){n.key===!0&&(i+="-"+String(e[t]))}),i};o.prototype.checkWrongDataTypes=function(t,e,n){if(!t||!n)return null;for(var i=[],o=0;o<n.length;o++)_(i,y(t,e,n[o],o));return i};var y=function(t,e,n,i){for(var o=[],a=0;a<t.length;a++)switch(t[a].dataType){case"code":var r=t[a].domain.codes[0].idCodeList;t[a].domain.codes[0].version&&(r=r+"|"+t[a].domain.codes[0].version),m(n[a],e[r],t[a])||o.push({error:s,dataIndex:i,colId:t[a].title,cListUID:r});break;case"year":b(n[a])?t[a].domain&&t[a].domain.period&&(t[a].domain.period.from&&n[a]<t[a].domain.period.from&&o.push({error:l,dataIndex:i,colId:t[a].id,yearLimitFrom:t[a].domain.period.from,yearValue:n[a]}),t[a].domain.period.to&&n[a]>t[a].domain.period.to&&o.push({error:l,dataIndex:i,colId:t[a].id,yearLimitTo:t[a].domain.period.to,yearValue:n[a]})):o.push({error:l,dataIndex:i,colId:t[a].id});break;case"month":C(n[a])||o.push({error:d,dataIndex:i,colId:t[a].id});break;case"date":w(n[a])||o.push({error:c,dataIndex:i,colId:t[a].id});break;case"customCode":break;case"number":case"percentage":D(n[a])||o.push({error:u,dataIndex:i,colId:a});break;case"bool":E(n[a])||o.push({error:h,dataIndex:i,colId:a})}return o},m=function(t,e,n){var o=new i,a=o.findCodeInCodelist(t,e,n);return null!=a||"flag"==n.subject},b=function(e){return!e||!!t.isNumeric(e)&&4==e.toString().length},C=function(e){return!e||!!t.isNumeric(e)&&(6==e.toString().length&&!(e.substring(4,6)>12||e.substring(4,6)<1))},w=function(e){return!e||!!t.isNumeric(e)&&(8==e.toString().length&&!(e.substring(4,6)>12||e.substring(4,6)<1))};o.prototype.checkValueFlags=function(t,e){};var D=function(e){return!e||(""==e||!!t.isNumeric(e))},E=function(t){return"boolean"==typeof t||("string"==typeof t&&("true"==t||"false"==t)||"number"==typeof t&&(1==t||0==t))},_=function(t,e){if(t||(t=[]),e)for(var n=0;n<e.length;n++)t.push(e[n])};o.prototype.dataAppendCheck=function(t,e,i){if(!t||!e||!i)return null;for(var o=[],a=0;a<e.length;a++)for(n=0;n<i.length;n++){var r=v(e[a],i[n],t);r&&o.push({dataOldIndex:a,dataNewIndex:n})}return o},o.prototype.dataMerge=function(t,e,n,i){for(var o=e.length,a=0;a<n.length;a++){for(var r=!1,s=0;s<o;s++)v(e[s],n[a],t)&&(r=!0,"keepOld"==i||"keepNew"==i&&x(n[a],e[s]));r||e.push(n[a])}return e};var x=function(t,e){for(var n=0;n<t.length;n++)e[n]=t[n]};return o}.apply(e,o),!(void 0!==a&&(t.exports=a))},function(t,e,n){var o,a;o=[n(2)],a=function(t){function e(e,n){this.config={fSep:n,rSep:"\r\n",quot:'"',head:!1,trim:!0},t.extend(!0,this.config,e),this.stringsArr}function n(t){for(var e=t[0].length-1;e>=0;e--)""==t[0][e].trim()&&o(t,e)}function o(t,e){for(var n=0;n<t.length;n++)t[n].splice(e,1)}function a(t){if(!t)throw new Error("Nothing to parse");if(!t[0])throw new Error("Nothing to parse");return t[0]}function r(t){var e=[];for(i=1;i<t.length;i++)e.push(t[i]);return e}function s(t,e){for(var n=[[""]],i=f=p=q=0;p<t.length;p++)switch(c=t.charAt(p)){case e.quot:q&&t.charAt(p+1)==e.quot?(n[i][f]+=e.quot,++p):q^=1;break;case e.fSep:q?n[i][f]+=c:(e.trim&&(n[i][f]=n[i][f].replace(/^\s\s*/,"").replace(/\s\s*$/,"")),n[i][++f]="");break;case e.rSep.charAt(0):q||e.rSep.charAt(1)&&(!e.rSep.charAt(1)||e.rSep.charAt(1)!=t.charAt(p+1))?n[i][f]+=c:(e.trim&&(n[i][f]=n[i][f].replace(/^\s\s*/,"").replace(/\s\s*$/,"")),n[++i]=[""],n[i][f=0]="",e.rSep.charAt(1)&&++p);break;default:n[i][f]+=c}return e.head&&n.shift(),n[n.length-1].length<n[0].length&&n.pop(),n}return this.defConfig={fSep:",",rSep:"\r\n",quot:'"',head:!1,trim:!0},e.prototype.convert=function(t){this.stringsArr=s(t,this.config),n(this.stringsArr)},e.prototype.getColumns=function(){return a(this.stringsArr)},e.prototype.getData=function(){return r(this.stringsArr)},e}.apply(e,o),!(void 0!==a&&(t.exports=a))},function(t,e,n){var o,a;o=[n(2),n(7),n(53),n(47),n(8)],a=function(t,e,n,o,a){function r(t,e){for(var n=0;n<e.length;n++)if(e[n]==t)return n;return-1}function s(t,e){for(var n="",i=0;i<e.length;i++)n+="<td>",n+=t[e[i]],n+="</td>";return n}var l={lang:"EN",maxRows:5},d={trDSD:"#trDSD",trCSV:"#trCSV",tblColMatch:"#tblColMatch"},c={rowDSD:"<td>%title%<br/>type: %type%</td>",rowCSV:'<td class="csvHead" style="cursor:move;" draggable="true"><div id="%colId%" draggable="true">%colId%</div></td>'},u=function(n){e.info("ColumnsMatch",n),this.config={},t.extend(!0,this.config,l,n),this.$cnt,this.$tblColMatch,this.$trDsd,this.$trCsv,this.dsd,this.csvCols,this.csvData,this.lang=this.config.lang.toLowerCase()};return u.prototype.render=function(i,o,a){e.info("ColumnsMatch render",i,o,a),t.extend(!0,this.config,o),this.$cnt=i,this.$cnt.html(n),this.$tblColMatch=this.$cnt.find(d.tblColMatch),this.$trDsd=this.$cnt.find(d.trDSD),this.$trCsv=this.$cnt.find(d.trCSV),this._bindEvents(),this._doML(),a&&a()},u.prototype.setData=function(t,e,n){this.dsd=t,this.csvCols=e,this.csvData=n;var i=t;if(this.$trDsd.html(""),this.$trCsv.html(""),i){for(var o=0;o<i.length;o++){var a=i[o].title[this.lang.toUpperCase()]||i[o].title[Object.keys(i[o].title)[0]],r=c.rowDSD.replace("%title%",a);r=r.replace("%type%",i[o].dataType),this.$trDsd.append(r)}for(o=0;o<e.length;o++)r=c.rowCSV.replace("%colId%",e[o]),r=r.replace("%colId%",e[o]),this.$trCsv.append(r),this.bindCsvHeadEvents();this._updateView(this.csvCols,this.csvData)}},u.prototype.getCsvCols=function(){e.info("ColumnsMatch getCsvCols",this.csvCols);for(var t=this._getColIndexes(this.csvCols),n=[],i=0;i<this.dsd.length;i++)n[i]=this.csvCols[t[i]];return n},u.prototype.getCsvData=function(){e.info("ColumnsMatch getCsvData");for(var t=this._getColIndexes(this.csvCols),n=[],i=0;i<this.csvData.length;i++){for(var o=[],a=0;a<this.dsd.length;a++)o[a]=this.csvData[i][t[a]];n[i]=o}return n},u.prototype._updateView=function(t,n){e.info("ColumnsMatch _updateView",t,n);var o=this.config.maxRows;n.length<o&&(o=n.length),this._removeDataRows();var a=this._getColIndexes(t),r="";for(i=0;i<o;i++)r+="<tr>"+s(n[i],a)+"</tr>";for(r+="<tr>",i=0;i<a.length;i++)r+="<td>...</td>";r+="</tr>",this.$tblColMatch.append(r)},u.prototype._getColIndexes=function(n){e.info("ColumnsMatch _getColIndexes",n);for(var i=this.$trCsv.find("td"),o=[],a=0;a<i.length;a++){var s=t(i[a]).find("div")[0].id;o[a]=r(s,n)}return e.info("ColumnsMatch _getColIndexes<",o),o},u.prototype._removeDataRows=function(){var t=this.$tblColMatch.find("tr");if(t.length>2)for(var e=2;e<t.length;e++)t[e].remove()},u.prototype._bindEvents=function(){},u.prototype.bindCsvHeadEvents=function(){for(var e=this.$trCsv.find(".csvHead"),n=this,i=0;i<e.length;i++)t(e[i]).on("drop",function(t){n.drop(t)}),t(e[i]).on("dragover",n.allowDrop),t(e[i]).find("div").on("dragover",n.allowDrop),t(e[i]).find("div").on("dragstart",n.drag)},u.prototype._doML=function(){},u.prototype.drag=function(t){t.originalEvent.dataTransfer.setData("text",t.target.id)},u.prototype.allowDrop=function(t){t.preventDefault()},u.prototype.drop=function(e){e.preventDefault();var n,i,o=e.originalEvent.dataTransfer.getData("text"),a=t("div[id='"+o+"']"),r=a.parent();t(e.target).is("div")?(n=t(e.target),i=n.parent()):(i=t(e.target),n=i.find("div")),n.remove(),a.remove(),i.append(a),r.append(n),this._updateView(this.csvCols,this.csvData),this.bindCsvHeadEvents()},u}.apply(e,o),!(void 0!==a&&(t.exports=a))},function(t,e,n){var i=n(21);t.exports=(i.default||i).template({compiler:[7,">= 4.0.0"],main:function(t,e,n,i,o){return'<table id="tblColMatch" class="table table-bordered">\r\n    <tbody>\r\n        <tr id="trDSD"></tr>\r\n        <tr id="trCSV"></tr>\r\n    </tbody>\r\n</table>'},useData:!0})},function(t,e,n){var i=n(21);t.exports=(i.default||i).template({
compiler:[7,">= 4.0.0"],main:function(t,e,n,i,o){var a,r=null!=e?e:{},s=n.helperMissing,l="function",d=t.escapeExpression;return'<div data-status="loading" id="DataLoading" class="text-center">\r\n    <span class="loading loading-48"></span>\r\n</div>\r\n<div data-status="loaded" id="DataLoaded" style="display:none">\r\n    <div id="divValRes" style="display:none"></div>\r\n    <div id="DataUploadColsMatch" style="display:none">\r\n        <div class="row">\r\n            <div class="col-xs-12">\r\n                <p id="DataMatchColumn">\r\n                    Match the DSD columns with the CSV ones\r\n                </p>\r\n                <div id="divCsvMatcher">\r\n\r\n                </div>\r\n                <p>\r\n                    <button id="btnCsvMatcherOk" type="button" class="btn btn-primary">Ok</button>\r\n                    <button id="btnCsvMatcherCancel" type="button" class="btn btn-default">Cancel</button>\r\n                </p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div id="DataUploadContainer" style="display:none">\r\n        <div class="row">\r\n            <div class="col-xs-12">\r\n                <p id="DataDuplicateFound" class="text-center">\r\n                    Some duplicated values found, keep old data or replace with the new values just uploaded?\r\n                </p>\r\n                <p class="text-center">\r\n                    <button id="btnDataMergeKeepNew" type="button" class="btn btn-default">Replace with new values</button>\r\n                    <button id="btnDataMergeKeepOld" type="button" class="btn btn-default">Keep old values</button>\r\n                    <button id="btnDataMergeCancel" type="button" class="btn btn-default">Cancel</button>\r\n                </p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div id="divDataEditor">\r\n        <div id="divDataGridBtns">\r\n            <button title="'+d((a=null!=(a=n.btnClear||(null!=e?e.btnClear:e))?a:s,typeof a===l?a.call(r,{name:"btnClear",hash:{},data:o}):a))+'" id="DataDeleteAll" type="button" class="btn btn-floating fx-background-color-primary-color"><span class="icojam_delete"></span></button>\r\n            <button  title="'+d((a=null!=(a=n.btnAdd||(null!=e?e.btnAdd:e))?a:s,typeof a===l?a.call(r,{name:"btnAdd",hash:{},data:o}):a))+'" id="btnAddRow" type="button" class="btn btn-floating fx-background-color-primary-color"><span class="icojam_add"></span></button>\r\n        </div>\r\n        <div id="divDataEdit"> </div>\r\n    </div>\r\n\r\n</div>\r\n\r\n\r\n'},useData:!0})},function(t,e){}])});
//# sourceMappingURL=fenix-ui-DataEditor.min.js.map